<?php
/**
 * @file
 * Code for the communities feature.
 */

include_once('communities.features.inc');


/*
* hook_disable
*/
function communities_disable() {
  _disable_content_type('community');
}



/*
* hook_views_pre_render
*/
function communities_views_pre_render(&$view) {
  if($view->name == 'communities_directory') {
    $alphabet = array('a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z');
    $output = '<ul class="glossary">';
    foreach($alphabet as $letter) {
      $url = $_GET['q'].'/'.$letter;
      $output .= '<li>'.l($letter, $url).'</li>';
    }
    $output .= '<div class="add_content">'.l(t('create a new community'),'node/add/community').'</div>';
    $view->header['area']->options['content'] = $output;
  }
}



/*
* hook_init
*/
function communities_init() {
  drupal_add_css(drupal_get_path('module', 'communities') . '/communities.css');
}



/*
* hook_modules_enabled
*/
function communities_modules_enabled($modules) {
  if (in_array('communities', $modules)) {
    node_access_rebuild();
  }
}
